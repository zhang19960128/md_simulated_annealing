This code is used to perform the simulated annealing.
